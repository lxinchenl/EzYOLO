# -*- coding: utf-8 -*-
"""
YOLO模型信息
自动生成的模型信息文件 - 包含所有Ultralytics支持的模型
"""

# 所有检测到的模型信息
ULTRALYTICS_MODELS = {
    "YOLOv11": {
        "l": {
            "filename": "yolo11l.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment"
            ],
            "parameters": {
                "total": 25372160,
                "trainable": 0,
                "total_m": 25.37
            },
            "num_classes": 80
        },
        "m": {
            "filename": "yolo11m.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment"
            ],
            "parameters": {
                "total": 20114688,
                "trainable": 0,
                "total_m": 20.11
            },
            "num_classes": 80
        },
        "n": {
            "filename": "yolo11n.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment"
            ],
            "parameters": {
                "total": 2623792,
                "trainable": 0,
                "total_m": 2.62
            },
            "num_classes": 80
        },
        "s": {
            "filename": "yolo11s.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment"
            ],
            "parameters": {
                "total": 9458752,
                "trainable": 0,
                "total_m": 9.46
            },
            "num_classes": 80
        },
        "x": {
            "filename": "yolo11x.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment"
            ],
            "parameters": {
                "total": 56966176,
                "trainable": 0,
                "total_m": 56.97
            },
            "num_classes": 80
        }
    },
    "YOLOv12": {
        "l": {
            "filename": "yolo12l.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 26454880,
                "trainable": 0,
                "total_m": 26.45
            },
            "num_classes": 80
        },
        "m": {
            "filename": "yolo12m.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 20201216,
                "trainable": 0,
                "total_m": 20.2
            },
            "num_classes": 80
        },
        "n": {
            "filename": "yolo12n.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 2603056,
                "trainable": 0,
                "total_m": 2.6
            },
            "num_classes": 80
        },
        "s": {
            "filename": "yolo12s.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 9285632,
                "trainable": 0,
                "total_m": 9.29
            },
            "num_classes": 80
        },
        "x": {
            "filename": "yolo12x.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 59216928,
                "trainable": 0,
                "total_m": 59.22
            },
            "num_classes": 80
        }
    },
    "YOLOV10": {
        "b": {
            "filename": "yolov10b.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 20574384,
                "trainable": 0,
                "total_m": 20.57
            },
            "num_classes": 80
        },
        "l": {
            "filename": "yolov10l.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 25888688,
                "trainable": 0,
                "total_m": 25.89
            },
            "num_classes": 80
        },
        "m": {
            "filename": "yolov10m.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 16576768,
                "trainable": 0,
                "total_m": 16.58
            },
            "num_classes": 80
        },
        "n": {
            "filename": "yolov10n.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 2775520,
                "trainable": 0,
                "total_m": 2.78
            },
            "num_classes": 80
        },
        "s": {
            "filename": "yolov10s.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 8128272,
                "trainable": 0,
                "total_m": 8.13
            },
            "num_classes": 80
        },
        "x": {
            "filename": "yolov10x.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 31808960,
                "trainable": 0,
                "total_m": 31.81
            },
            "num_classes": 80
        }
    },
    "YOLOV3": {
        "n": {
            "filename": "yolov3-sppu.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 12173248,
                "trainable": 0,
                "total_m": 12.17
            },
            "num_classes": 80
        },
        "u": {
            "filename": "yolov3u.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 103754144,
                "trainable": 0,
                "total_m": 103.75
            },
            "num_classes": 80
        }
    },
    "YOLOV5": {
        "lu": {
            "filename": "yolov5lu.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 53225024,
                "trainable": 0,
                "total_m": 53.23
            },
            "num_classes": 80
        },
        "mu": {
            "filename": "yolov5mu.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 25111456,
                "trainable": 0,
                "total_m": 25.11
            },
            "num_classes": 80
        },
        "nu": {
            "filename": "yolov5nu.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 2654816,
                "trainable": 0,
                "total_m": 2.65
            },
            "num_classes": 80
        },
        "su": {
            "filename": "yolov5su.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 9153152,
                "trainable": 0,
                "total_m": 9.15
            },
            "num_classes": 80
        },
        "xu": {
            "filename": "yolov5xu.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 97276448,
                "trainable": 0,
                "total_m": 97.28
            },
            "num_classes": 80
        }
    },
    "YOLOV8": {
        "l": {
            "filename": "yolov8l.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment",
                "world"
            ],
            "parameters": {
                "total": 43691520,
                "trainable": 0,
                "total_m": 43.69
            },
            "num_classes": 80
        },
        "m": {
            "filename": "yolov8m.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment",
                "world"
            ],
            "parameters": {
                "total": 25902640,
                "trainable": 0,
                "total_m": 25.9
            },
            "num_classes": 80
        },
        "n": {
            "filename": "yolov8n.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment"
            ],
            "parameters": {
                "total": 3157200,
                "trainable": 0,
                "total_m": 3.16
            },
            "num_classes": 80
        },
        "s": {
            "filename": "yolov8s.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment",
                "world"
            ],
            "parameters": {
                "total": 11166560,
                "trainable": 0,
                "total_m": 11.17
            },
            "num_classes": 80
        },
        "x": {
            "filename": "yolov8x.pt",
            "tasks": [
                "detect",
                "classify",
                "obb",
                "pose",
                "segment",
                "world"
            ],
            "parameters": {
                "total": 68229648,
                "trainable": 0,
                "total_m": 68.23
            },
            "num_classes": 80
        }
    },
    "YOLOV9": {
        "c": {
            "filename": "yolov9c.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 25590912,
                "trainable": 0,
                "total_m": 25.59
            },
            "num_classes": 80
        },
        "e": {
            "filename": "yolov9e.pt",
            "tasks": [
                "detect"
            ],
            "parameters": {
                "total": 58206592,
                "trainable": 0,
                "total_m": 58.21
            },
            "num_classes": 80
        },
        "m": {
            "filename": "yolov9m.pt",
            "tasks": [
                "detect"
            ]
        },
        "s": {
            "filename": "yolov9s.pt",
            "tasks": [
                "detect"
            ]
        },
        "t": {
            "filename": "yolov9t.pt",
            "tasks": [
                "detect"
            ]
        }
    }
}


# 按版本组织的模型
VERSIONS = {
    "YOLOV10": ['b', 'l', 'm', 'n', 's', 'x'],
    "YOLOV3": ['n', 'u'],
    "YOLOV5": ['lu', 'mu', 'nu', 'su', 'xu'],
    "YOLOV8": ['l', 'm', 'n', 's', 'x'],
    "YOLOV9": ['c', 'e', 'm', 's', 't'],
    "YOLOv11": ['l', 'm', 'n', 's', 'x'],
    "YOLOv12": ['l', 'm', 'n', 's', 'x'],
}


# 型号名称映射（中文）
SIZE_NAMES = {
    "n": "nano (超轻量)",
    "s": "small (轻量)",
    "m": "medium (中等)",
    "l": "large (大)",
    "x": "xlarge (超大)",
    "tiny": "tiny (超轻量)",
    "t": "tiny (超轻量)",
    "c": "compact (紧凑)",
    "e": "extended (扩展)",
    "b": "balanced (平衡)",
}


# 任务类型映射
TASK_NAMES = {
    "detect": "目标检测",
    "segment": "实例分割",
    "classify": "图像分类",
    "pose": "姿态估计",
    "obb": "旋转框检测",
    "world": "开放词汇检测",
}


def get_model_info(version: str, size: str, task: str = "detect") -> dict:
    """
    获取模型信息
    
    Args:
        version: 版本名称，如 "YOLOv8"
        size: 型号，如 "n", "s", "m", "l", "x"
        task: 任务类型，如 "detect", "segment", "classify"
    
    Returns:
        模型信息字典
    """
    version_data = ULTRALYTICS_MODELS.get(version, {})
    size_data = version_data.get(size, {})
    
    # 获取对应任务的文件名
    tasks = size_data.get('tasks', [])
    filename = None
    
    if task in tasks:
        # 构建文件名
        base = f"{version.lower().replace('v', '')}{size}"
        if task != 'detect':
            base += f"-{task}"
        filename = f"{base}.pt"
    else:
        # 使用第一个可用任务
        if tasks:
            filename = size_data.get('filename')
    
    info = {
        'version': version,
        'size': size,
        'task': task,
        'filename': filename,
        'available_tasks': tasks,
    }
    
    # 添加测试信息
    if 'parameters' in size_data:
        info['parameters'] = size_data['parameters']
    if 'gflops' in size_data:
        info['gflops'] = size_data['gflops']
    if 'layers' in size_data:
        info['layers'] = size_data['layers']
    
    return info


def format_model_info(info: dict) -> str:
    """格式化模型信息显示"""
    lines = [
        f"版本: {info.get('version', '-')}",
        f"型号: {info.get('size', '-')}",
        f"任务: {TASK_NAMES.get(info.get('task', ''), info.get('task', '-'))}",
    ]
    
    if 'parameters' in info:
        params = info['parameters']
        lines.append(f"参数量: {params.get('total_m', '-')}M")
    
    if 'gflops' in info:
        lines.append(f"FLOPs: {info['gflops']} GFLOPs")
    
    if 'layers' in info:
        lines.append(f"层数: {info['layers']}")
    
    lines.append(f"文件名: {info.get('filename', '-')}")
    
    return "\n".join(lines)


def list_all_models():
    """列出所有可用模型"""
    print("=" * 60)
    print("Ultralytics YOLO 模型列表")
    print("=" * 60)
    
    for version in sorted(ULTRALYTICS_MODELS.keys()):
        print(f"\n{version}:")
        sizes = ULTRALYTICS_MODELS[version]
        for size in sorted(sizes.keys()):
            info = sizes[size]
            tasks = ", ".join([TASK_NAMES.get(t, t) for t in info.get('tasks', [])])
            params = info.get('parameters', {}).get('total_m', '-')
            gflops = info.get('gflops', '-')
            print(f"  [{size:5s}] {tasks:20s} | 参数量: {params:>6s}M | FLOPs: {gflops:>6s}G")


if __name__ == "__main__":
    list_all_models()
